# sbt blowout

[![CI & CD](https://github.com/taig/sbt-blowout/actions/workflows/main.yml/badge.svg)](https://github.com/taig/sbt-blowout/actions/workflows/main.yml)
[![sbt-blowout-core Scala version support](https://index.scala-lang.org/taig/sbt-blowout/sbt-blowout-core/latest-by-scala-version.svg?targetType=Sbt)](https://index.scala-lang.org/taig/sbt-blowout/sbt-blowout-core)
[![Scala Steward badge](https://img.shields.io/badge/Scala_Steward-helping-blue.svg?style=flat&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAMAAAARSr4IAAAAVFBMVEUAAACHjojlOy5NWlrKzcYRKjGFjIbp293YycuLa3pYY2LSqql4f3pCUFTgSjNodYRmcXUsPD/NTTbjRS+2jomhgnzNc223cGvZS0HaSD0XLjbaSjElhIr+AAAAAXRSTlMAQObYZgAAAHlJREFUCNdNyosOwyAIhWHAQS1Vt7a77/3fcxxdmv0xwmckutAR1nkm4ggbyEcg/wWmlGLDAA3oL50xi6fk5ffZ3E2E3QfZDCcCN2YtbEWZt+Drc6u6rlqv7Uk0LdKqqr5rk2UCRXOk0vmQKGfc94nOJyQjouF9H/wCc9gECEYfONoAAAAASUVORK5CYII=)](https://scala-steward.org)

> sbt plugin for generating configuration files

## Installation

```scala
addSbtPlugin("io.taig" % "sbt-blowout-core" % "[version]")
addSbtPlugin("io.taig" % "sbt-blowout-json-circe" % "[version]")
addSbtPlugin("io.taig" % "sbt-blowout-yaml-circe" % "[version]")
```

## Quickstart

1. Register generators

   ```scala
   enablePlugins(BlowoutPlugin)
   
   blowoutGenerators += BlowoutGenerator.strict(
     file("my-config.yml"),
     content = s"""version: ${scalaVersion.value}""".stripMargin
   )
   ```

2. Install generators via sbt

   ```shell
   sbt blowoutGenerate
   ```

3. Verify that your files generated by sbt-blowout are up-to-date, ideally as part of your CI pipeline

   ```shell
   sbt blowoutCheck
   ```
   
## Guide

sbt-blowout generates configuration files of arbitrary formats and extensions with the `sbt-blowout-core` module. Other modules (like `sbt-blowout-yaml-circe`) provide additional helpers on top of that to ease generation of specific file formats. sbt-blowout can be useful to generate CI configurations (such as GitHub Action workflows), Dockerfiles, cloud deployment configurations or any other configuration file that can benefit from access to the sbt build configuration.

### YAML

The YAML module uses [circe-yaml](https://github.com/circe/circe-yaml) in order to provide the convenient circe JSON builders before converting the AST to YAML.

```scala
blowoutGenerators += BlowoutYamlGenerator.strict(
   file("my-config.yml"),
   content = Json.obj("version" := scalaVersion.value)
)
```

### JSON

The JSON module uses [circe](https://github.com/circe/circe) in order to provide the convenient circe JSON builders.

```scala
blowoutGenerators += BlowoutJsonGenerator.strict(
   file("my-config.json"),
   content = Json.obj("version" := scalaVersion.value)
)
```

## Example

Take a look at the [GithubActionsGenerator](/project/GitHubActionsGenerator.scala) file which is used to generate the GitHub Action workflows that build and deploy this project. The generators are registered at the root project in the [build.sbt](/build.sbt#L18-L23) and the generated files can be found in the [.github/workflows/](/.github/workflows/) folder.

## Acknowledgements

This plugin is highly inspired by [sbt-github-actions](https://github.com/djspiewak/sbt-github-actions) which provides a very similar workflow, but is limited to generating GitHub Actions workflow configuration files.